<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pandas," />










<meta name="description" content="12345import pandasimport numpydf_sales = pandas.read_excel(&quot;sales.xlsx&quot;)print(df_sales.head())print(df_sales.shape)">
<meta name="keywords" content="pandas">
<meta property="og:type" content="article">
<meta property="og:title" content="“python数据分析与机器学习实战-07.Pandas数据预处理”">
<meta property="og:url" content="http://yoursite.com/2018/12/07/“python数据分析与机器学习实战-07-Pandas数据预处理”/index.html">
<meta property="og:site_name" content="Carlos">
<meta property="og:description" content="12345import pandasimport numpydf_sales = pandas.read_excel(&quot;sales.xlsx&quot;)print(df_sales.head())print(df_sales.shape)">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-12-07T05:14:55.674Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="“python数据分析与机器学习实战-07.Pandas数据预处理”">
<meta name="twitter:description" content="12345import pandasimport numpydf_sales = pandas.read_excel(&quot;sales.xlsx&quot;)print(df_sales.head())print(df_sales.shape)">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/07/“python数据分析与机器学习实战-07-Pandas数据预处理”/"/>





  <title>“python数据分析与机器学习实战-07.Pandas数据预处理” | Carlos</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Carlos</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/07/“python数据分析与机器学习实战-07-Pandas数据预处理”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Carlos">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Carlos">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">“python数据分析与机器学习实战-07.Pandas数据预处理”</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-12-07T13:12:32+08:00">
                2018-12-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/数据分析/" itemprop="url" rel="index">
                    <span itemprop="name">数据分析</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas</span><br><span class="line"><span class="keyword">import</span> numpy</span><br><span class="line">df_sales = pandas.read_excel(<span class="string">"sales.xlsx"</span>)</span><br><span class="line">print(df_sales.head())</span><br><span class="line">print(df_sales.shape)</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<pre><code>                  门店  区域         11月总销售        11月总毛利         目标销售     实际完成  \
0  好药师大药房连锁有限公司团结新村店  蔡静  103617.600000  37506.576000  2898.394406  1643.08   
1    武汉市好药师文华大药房有限公司  蔡静  136347.184988  46358.042896  3813.907272  3234.51   
2    好药师大药房连锁有限公司七里店  蔡静  153700.000000  61480.000000  4299.300699  5682.10   
3    好药师大药房连锁有限公司汉城店  蔡静  127200.000000  49544.400000  3558.041958  4836.00   
4  好药师大药房连锁有限公司太子水榭店  蔡静   74200.000000  23744.000000  2075.524476   657.38   

      销售完成率   实际完成.1  
0  0.566893   528.70  
1  0.848083  1085.40  
2  1.321634  1728.18  
3  1.359175  2116.98  
4  0.316730     4.48  
(48, 8)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 算数运算</span></span><br><span class="line"><span class="comment">#print(df_sales["销售完成率"]*100)</span></span><br><span class="line">new_column = df_sales[<span class="string">"目标销售"</span>]+df_sales[<span class="string">"实际完成"</span>]</span><br><span class="line">df_sales[<span class="string">'销售'</span>] = new_column</span><br><span class="line">print(df_sales.shape)</span><br></pre></td></tr></table></figure>
<pre><code>(48, 9)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#取最大值</span></span><br><span class="line">print(df_sales[<span class="string">"11月总毛利"</span>]/df_sales[<span class="string">"11月总毛利"</span>].max())</span><br></pre></td></tr></table></figure>
<pre><code>0     0.085602
1     0.105803
2     0.140316
3     0.113076
4     0.054191
5     0.047801
6     0.244915
7     1.000000
8     0.027616
9     0.051923
10    0.125299
11    0.156853
12    0.205408
13    0.280382
14    0.205408
15    0.066929
16    0.251054
17    0.116553
18    0.124250
19    0.067784
20    0.057423
21    0.000000
22    0.212081
23    0.064224
24    0.136869
25    0.000000
26    0.693822
27    0.337782
28    0.089752
29    0.000000
30    0.139677
31    0.073400
32    0.198362
33    0.145881
34    0.109551
35    0.035946
36    0.087298
37    0.284832
38    0.240555
39    0.086614
40    0.353353
41    0.077599
42    0.156110
43    0.102704
44    0.077350
45    0.090379
46    0.120506
47    0.048887
Name: 11月总毛利, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#排序</span></span><br><span class="line">df_sales.sort_values(<span class="string">"11月总毛利"</span>,inplace=<span class="keyword">True</span>)</span><br><span class="line">print(df_sales[<span class="string">"11月总毛利"</span>])</span><br></pre></td></tr></table></figure>
<pre><code>29         0.000000
25         0.000000
21         0.000000
8      12100.000000
35     15750.000000
5      20944.000000
47     21420.000000
9      22750.000000
4      23744.000000
20     25160.000000
23     28139.925000
15     29325.000000
19     29699.610400
31     32160.400000
44     33891.000000
41     34000.000000
0      37506.576000
39     37950.000000
36     38250.000000
28     39325.000000
45     39600.000000
43     45000.000000
1      46358.042896
34     48000.000000
3      49544.400000
17     51068.000000
46     52800.000000
18     54440.670000
10     54900.080896
24     59969.500000
30     61200.000000
2      61480.000000
33     63918.000000
42     68400.000000
11     68725.552000
32     86912.812541
14     90000.000000
12     90000.192024
22     92923.865784
38    105400.000000
6     107310.000000
16    110000.000000
13    122850.000000
37    124800.000000
27    148000.000000
40    154822.662039
26    304000.000000
7     438152.548219
Name: 11月总毛利, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#降序排列</span></span><br><span class="line">df_sales.sort_values(<span class="string">"11月总毛利"</span>,inplace=<span class="keyword">True</span>,ascending=<span class="keyword">False</span>)</span><br><span class="line">print(df_sales[<span class="string">"11月总毛利"</span>])</span><br></pre></td></tr></table></figure>
<pre><code>7     438152.548219
26    304000.000000
40    154822.662039
27    148000.000000
37    124800.000000
13    122850.000000
16    110000.000000
6     107310.000000
38    105400.000000
22     92923.865784
12     90000.192024
14     90000.000000
32     86912.812541
11     68725.552000
42     68400.000000
33     63918.000000
2      61480.000000
30     61200.000000
24     59969.500000
10     54900.080896
18     54440.670000
46     52800.000000
17     51068.000000
3      49544.400000
34     48000.000000
1      46358.042896
43     45000.000000
45     39600.000000
28     39325.000000
36     38250.000000
39     37950.000000
0      37506.576000
41     34000.000000
44     33891.000000
31     32160.400000
19     29699.610400
15     29325.000000
23     28139.925000
20     25160.000000
4      23744.000000
9      22750.000000
47     21420.000000
5      20944.000000
35     15750.000000
8      12100.000000
21         0.000000
25         0.000000
29         0.000000
Name: 11月总毛利, dtype: float64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#求每个区域当天实际总销售</span></span><br><span class="line">area_sales = df_sales.pivot_table(index = <span class="string">"区域"</span>,values = <span class="string">"实际完成"</span>,aggfunc = numpy.sum)</span><br><span class="line">print(area_sales.sort_values(<span class="string">"实际完成"</span>))</span><br></pre></td></tr></table></figure>
<pre><code>         实际完成
区域           
熊红萍   9546.41
廖燕妮  29542.66
胡萍   48549.48
李宁   65614.81
涂梦芸  75627.41
蔡静   78091.85
</code></pre>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pandas/" rel="tag"># pandas</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/07/“python数据分析与机器学习实战-06-Pandas数据读取、索引及计算”/" rel="next" title="“python数据分析与机器学习实战-06.Pandas数据读取、索引及计算”">
                <i class="fa fa-chevron-left"></i> “python数据分析与机器学习实战-06.Pandas数据读取、索引及计算”
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/07/“python数据分析与机器学习实战-08-Pandas自定义函数”/" rel="prev" title="“python数据分析与机器学习实战-08.Pandas自定义函数”">
                “python数据分析与机器学习实战-08.Pandas自定义函数” <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpeg"
                alt="Carlos" />
            
              <p class="site-author-name" itemprop="name">Carlos</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">37</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/carloszo" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:carlos@cishao.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.facebook.com/karl.zuo" target="_blank" title="FB Page">
                      
                        <i class="fa fa-fw fa-facebook"></i>FB Page</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.linkedin.com/in/江华-左-69a37bb1/" target="_blank" title="Linkedin">
                      
                        <i class="fa fa-fw fa-globe"></i>Linkedin</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Carlos</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
